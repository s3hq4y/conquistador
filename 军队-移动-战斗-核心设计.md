# 核心设计文档 — 军队 / 移动 / 战斗

来源：`军队-组成-移动-战斗.md`

目的：提取并保留规则的最小集合，供设计决策与快速参考使用。只包含对玩法有直接影响的要点、数值与判定方法，去除示例、界面说明和次要例外。

=== 关键常量（速查）
- 单位战力上限：轴心 7，盟军 6（特例：美军指挥部 4）。
- 经验范围：0–400；等级分档：新兵(0–99)、普通(100–199)、老兵(200–299)、精英(300–400)。
- 每单位行动点(AP)：1。
- 装甲偏移上限：+5；火炮偏移上限：5。
- 散兵转化概率：盟军66%、轴心50%、苏联33%。

=== 单位（Composition）
- 单位由若干“战力”与可选的“特种兵战力”构成；战力有活跃与被压制两种状态，被压制战力在恢复或补给下可变为活跃。
- 特种兵（炮兵/工兵/侦察/两栖等）以单点形式影响战力、偏移与特殊行动；盟军最多3个特种兵，轴心通常1–2个。
- 牵引式装备在移动时进入牵引压制，直到下一个敌方回合恢复；损失时按损失队列（左→右）处理。
- 经验（XP）影响战斗偏移、补给耐受与恢复速度；增援降低经验（普通增援 −20 XP/战力，精英增援 −5 XP/战力）。

=== 移动（Movement）
- 每单位在回合开始获得 MP；进入每个六角格消耗 MP（受地形/天气影响）。特殊值：A=需要全部 MP 且锁定 AP；X=不可通行（道路/铁路例外）。
- AP 用途：发动攻击或换取扩展移动（扩展移动消耗 AP 并可能导致无法攻击）。AP 状态：可用、锁定、已消耗。
- 铁路/道路：行经每格 1 MP；受天气限制（泥泞/雪影响道路/铁路可用性）。
- 河流：小河需全部 MP 且锁定 AP；主河不可直接横渡（需总部行动/渡河）。桥梁（固定/浮桥）改变可通行性并影响补给。
- 控制区(ZOC)：非虚弱单位对相邻格施加 ZOC；进入敌方 ZOC 消耗所有剩余 MP 并锁定 AP，且不能通过扩展移动进入。
- 前线与占领：移动进入敌方半地会占领路径上的格子（有例外：补给不足、侦察特种兵等）。

=== 战斗（Combat）
- 基本判定：攻方战力 = 攻击值 × 活跃战力数（含活跃特种兵攻击）；守方战力 = 防御值 × 活跃战力数 + 特种兵防御值。比值确定基础赔率，再应用偏移。
- 主要偏移：
  - 装甲偏移 = (攻方装甲总 − 守方装甲总) / 10，最大 +5；在特定地形/条件下失效或受惩罚（城市、林地、山地等）。
  - 火炮偏移由特定特种兵提供，山地/废墟/某些工事内为 0，最大 5。
  - 其他偏移：河流（跨小河 −2，工程/两栖可抵消）、壕沟/工事（−1/−2）、经验差、峭壁/山脊等。
- 损失与随机性：最终赔率会被“随机化”（以赔率为中心、σ=1 的正态抽样并四舍五入），然后查表决定阵亡/压制等后果。
- 散兵（Broken）：损失可转为散兵（1–3 战力），按国籍概率；散兵不可被玩家移动，回合开始会自动朝总部或补给中枢移动并重组；3 点散兵使格子移动成本至少为 3。
- 撤退与奇袭：撤退按表决策并受“不能撤退”等命令影响；若防守撤退，攻方可能获得奇袭（保留 AP）的机会。

=== 特殊防御命令（核心效果）
- 不能撤退：降低撤退概率（撤退偏移 −2）但增加损失（损失偏移 +1）；在攻击后撤退时该标记移除。
- 后卫部队：受攻击时按佯攻处理，随后以满 MP 撤退至总部并变为虚弱。
- 反击：仅装甲单位可在敌方回合选择反击（消耗剩余 AP/MP），以交换攻守的方式战斗并获 +2 偶然偏移。

=== 战斗副作用与工程
- 城市可被炮击变为废墟（概率随火炮偏移增加），防守单位重大损失可削弱/摧毁防御工事，工兵在移除壕沟/减工事方面有显著作用。

=== 设计含义（给系统设计者的结论）
- 1) 资源与风险平衡：AP/MP、补给与经验形成游戏的核心权衡，过度推进会快速暴露补给脆弱性。
- 2) 组合兵种价值：装甲、炮兵与工兵在合适地形的互相配合能显著提升攻势成功率——UI/提示应明确展示这些叠加效应。
- 3) 随机性管理：赔率的随机化允许"戏剧性"战果，设计需通过信息提示与可预期的概率展示减少玩家挫败感。
- 4) 散兵与重组路径：散兵机制把战斗损失延伸为后勤挑战，鼓励玩家维持补给与总部可达性。

=== 快速建议（可选实现/界面）
- 在单位面板突出显示：当前活跃战力 / 被压制战力、AP 状态、预期装甲/火炮偏移数值。
- 在移动界面显示：进入格的累计补给中断值、是否会锁定 AP（进入 A 格或过河）、进入敌方 ZOC 是否会消耗剩余 MP。
- 在战斗预览中显示：最终赔率范围（含 ±2 的常见波动）、主要偏移来源与合计偏移值。

文件已保存：`军队-移动-战斗-核心设计.md`
